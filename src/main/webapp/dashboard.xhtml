<?xml version="1.0" encoding="UTF-8"?>

<ui:composition template="template.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:define name="title">Dashboard</ui:define>

    <ui:define name="content">
        <h1 id="header">Dashboard</h1>
        <p>Yep, you are inside!</p>
        <a href="/j_spring_security_logout">Logout</a>
        <ui:fragment rendered="#{dashboardBean.rpmOf.size() != 0}">    
            <h2>Unassigned artifacts:</h2>
            <c:forEach items="#{dashboardBean.rpmOf}" var="team">
                <div style="border:1px black solid; margin:10px; padding:10px;">
                    <h3>For team: Team #{team.id}</h3>
                    <ul>
                        <c:forEach items="#{dashboardBean.getUnassignedArtifacts(team)}" var="artifact">
                            <li><a href="/assignArtifact.xhtml?artifactId=#{artifact.id}">#{artifact.name}</a></li>
                        </c:forEach>
                    </ul>
                </div>
            </c:forEach>
        </ui:fragment>
        
        <ui:fragment rendered="#{reviewartifactBean.unreviewedArtifacts.size() != 0}">    
            <h2>Artifacts to review</h2>
            <ul>
            <c:forEach items="#{reviewartifactBean.unreviewedArtifacts}" var="artifact">
                <li><a href="/reviewArtifact.xhtml?artifactId=#{artifact.id}">#{artifact.name}</a></li>
            </c:forEach>
            </ul>
        </ui:fragment>
        
        <ui:fragment rendered="#{dashboardBean.teams.size() != 0}">    
            <h2>Your teams</h2>          
            <c:forEach items="#{dashboardBean.teams}" var="team">
                <div style="border:1px black solid; margin:10px; padding:10px;">
                    <h3>#{team.course.name} (team #{team.id})</h3>
                    <h4>Submitted artifacts</h4>
                    <c:forEach items="#{team.artifacts}" var="artifact">
                        <h:form>
                            <p:commandButton value="#{artifact.name}" ajax="false">
                                <p:fileDownload value="#{reviewartifactBean.getArtifactFile(artifact.id)}" />
                            </p:commandButton>
                        </h:form>
                    </c:forEach>
                    <a href="/submitArtifact.xhtml?teamId=#{team.id}">Submit artifact</a>
                </div>
            </c:forEach>
        </ui:fragment>

        
        <a href="/createTeam.xhtml">Create Team</a>
    </ui:define>
</ui:composition>
